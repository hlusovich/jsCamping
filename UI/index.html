<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="keywords" content="zavodnoi apelsin chat">
    <meta name="author" content="Klusovich">
    <link rel="shortcut icon" href="assets/images/апельсинка%20без%20фона.png" type="image/x-icon">
    <title>ZA</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Lobster&display=swap" rel="stylesheet">
</head>
<body>
<main class="main">
    <header class="header" id="header">
        <div>
            <div class="header__logo"><img src="assets/images/апельсинка%20без%20фона.png" alt="logo"/></div>
            <h1 class="header__title">Заводной апельсин</h1>
        </div>
        <div class="mobile">
            <img class="mobile__search-toggle" src="assets/images/filter.png" alt="filter"/>
            <div class="mobile__burger-menu "></div>
        </div>
        <div id="profile" class="profile">
        </div>
    </header>
    <section class="users">
        <div class="user-search">
            <img src="assets/images/ant-design_search-outlined.png" alt="search-icon"/>
            <input placeholder="Поиск"/>
        </div>
        <div class="users-types">
            <span class="users-types__all">Все</span>
            <span class="users-types__onlain">Онлайн</span>
        </div>
        <article id="users-list" class="users-list">
        </article>
    </section>
    <section class="messages">
        <div class="messages-header">
            <div class="messages-header__chat">
                <div class="messages-header__chat-name  orange">DC</div>
                <span>DM Courses</span>
            </div>
            <article class="filters">
                <div class="filters__item">
                    <div>
                        <img src="assets/images/search.png" alt="search"/>
                    </div>
                    <img class="filters__item_icon" src="assets/images/man.png" alt="text-filter">
                    <input type="text" placeholder="Поиск"/>
                </div>
                <div class="filters__item">
                    <div>
                        <img src="assets/images/search.png" alt="search"/>
                    </div>
                    <img class="filters__item-img_mobile" src="assets/images/text.png" alt="user-filter"/>
                    <input type="text" placeholder="Поиск"/>
                </div>
                <div class="filters__item-date">
                    <div>
                        <div>C</div>
                        <input type="date"/>
                    </div>
                    <div class="filters__item-date_mobile">
                        <div>ПО</div>
                        <input type="date"/>
                    </div>
                </div>
                <div class="filters__buttons">
                    <button class="filter__button button-disabled">Поиск</button>
                    <button class="filter__button button-disabled">Отмена</button>
                </div>
            </article>
            <button class="chat-messages-button orange chat-button_active"><img src="assets/images/add%20message.png"
                                                                                alt="add-message-button"></button>
        </div>
        <div id="messages-list" class="messages-list">

        </div>
    </section>
    <section class="chat-input">
        <div>
            <input type="text" placeholder="Напишите свое сообщение..."/>
            <button class="chat-messages-button orange chat-button_active">
                <img src="assets/images/mdi_send.png" alt="add-message-button">
            </button>
        </div>
    </section>
    <footer class="footer">
        <div>
            <div class="footer__chat-name">Чат</div>
            <div class="footer__chat-name">Заводной апельсин</div>
        </div>
        <div class="footer__data">
            <h6 class="footer__data-personal">bigklu95@gmail.com</h6>
            <div class="footer__data-social-webs">
                <a href="https://www.instagram.com/"><img src="assets/images/telega.png" alt="telegram-logo"/></a>
                <a href="https://vk.com/feed"><img src="assets/images/vk.png" alt="vk-logo"/></a>
                <a href="https://telegram.org/"> <img src="assets/images/insta.png" alt="inst-logo"/></a>
            </div>
            <h6 class="footer__data-personal">Клусович Никита 18 10 2020</h6>
        </div>
    </footer>
</main>

</body>
<script src="script.js"></script>
<script>
    let messageCount = 0;
    const users = ["Js Camping", "Яна Ярошевич", "Виктор Виницкий", "Илон Маск", "Марк Цукенберг", "Роберт Родригез",
        "Дэн Абрамов", "Богдан Навсекайло", "Александра Карпова", "Носик Кокосик", "Евгений Жибрак", "Клусович Никита"];
    const activeUsers = ["Js Camping", "Яна Ярошевич", 'Виктор Винницкий', "Илон Маск", "Марк Цукенберг", "Роберт Родригез",
        "Дэн Абрамов", "Богдан Навсекайло", 'Евгений Жибрик', 'Клусович Никита', "Носик Кокосик"];
    const model = new MessageList(messages);
    const headerView = new HeaderView("profile");
    const messagesView = new MessagesView("messages-list");
    const activeUsersView = new ActiveUsersView("users-list");
    const userList = new UserList(users, activeUsers);

    function setCurrentUser(user) {
        if (model.changeUser(user)) {
            headerView.display(user);
            const messagesList = document.getElementById("messages-list");
            messagesList.innerHTML = "";
            messagesView.display(model.getPage(0, messageCount), model.user);
        }
    }

    function addMessage({text, isPersonal = false, to}) {
        if (model.add({text, isPersonal, to})) {
            const messagesList = document.getElementById("messages-list");
            messagesList.innerHTML = "";
            messageCount += 1;
            messagesView.display(model.getPage(0, messageCount), model.user);
            messageList.scrollTo(0, messageList.scrollHeight);
            console.log(model.messages)
        }

    }

    function editMessage(id, {text, isPersonal = false, to}) {
        if (model.edit(id, {text, isPersonal, to})) {
            const messagesList = document.getElementById("messages-list");
            messagesList.innerHTML = "";
            messagesView.display(model.getPage(0, messageCount), model.user);

        }

    }

    function removeMessage(id) {
        if (model.remove(id)) {
            const messagesList = document.getElementById("messages-list");
            messagesList.innerHTML = "";
            messageCount -= 1;
            messagesView.display(model.getPage(0, messageCount), model.user);
        }
    }

    function showMessages(skip, top = 10, filterConfig) {
        messagesView.display(model.getPage(messageCount, top, filterConfig), model.user);
        messageCount += top;
    }

    function showActiveUsers() {
        activeUsersView.display(userList.activeUsers);
    }

    setCurrentUser();
    setCurrentUser("Клусович Никита");
    showMessages();
    showActiveUsers();
    const messageList = document.getElementById("messages-list");
    messageList.scrollTo(0, messageList.scrollHeight);
    // имитация действий пользователя - вызовы методов addMessage, removeMessage, editMessage
    addMessage({text: "добавленное сообщение, имитиация лисенера события"});
    addMessage({text: "гурбангулы мухамедов открыл памятник алабаю"});
    console.log("меняем юзера");
    setCurrentUser("Js Camping");
    addMessage({text: "звучит как скороговорка"});
    addMessage({text: "добавленное сообщение, имитиация лисенера события2"});
    editMessage('10', {text: "нужно зарегистрировать логотип"});
    console.log("получаем еще 10 messages");
    showMessages(10, 10);
    console.log("удаляем сообщение с индексом 9");


</script>
</html>